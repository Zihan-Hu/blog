---
category:
  - 题解
tag:
  - 桶
excerpt: 一点点的数学推导，加上一点点的桶。
date: 2023-08-05
---

# ZROI P2592 题解

## 题面

::: details 点击此处展开题面

<!-- @include: ../../source/ZR-2605/problem.md -->

:::

## 解题

记 $f_i$ 为前 $i$ 个数中出现最多的数字。

根据加上第 $i$ 个数后的情况分类讨论：

1. 加上第 $i$ 个数后，$a_i$ 不是前 $i$ 个数中出现最多的数字
2. 加上第 $i$ 个数后，$a_i$ 是前 $i$ 个数中出现最多的数字

对于情况 1，有 $f_i = f_{i - 1}$。

对于情况 2，有 $f_i = a_i$。

如何判断 $a_i$ 是不是出现最多的那个呢？

建一个桶 $b$，$b_i$ 代表到 $i$ 出现过（包括当前计算到的）的次数。本题 $n \leq 10^7$，空间 1 GB，开得下。

对于第 $i$ 个数，记当前数字出现的次数 $b_{a_i}$ 为 $x$，记上一个数字出现的次数 $b_{a_{i - 1}}$ 为 $y$：如果 $x > y$，那么对应情况 1。如果 $x < y$，那么对应情况 2。

发现漏掉了 $x = y$ 的情况。题中说有多个时取值最小的那个，也就是：如果 $a_i < a_{i - 1}$，那么对应情况 1，否则对应情况 2。

发现 $f_i$ 与 $f$ 中除了 $f_{i - 1}$ 以外的元素都无关，所以只需要 $f_1$ 和 $f_2$ 滚动即可。

## 代码

@[code cpp](../../source/ZR-2605/bucket.cpp)
