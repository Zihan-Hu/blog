---
category:
  - 题解
tag:
  - 2023 暑期集训
  - DP
  - 滚动数组
excerpt: 【WIP】动态规划解决，使用滚动数组优化。
---

# ZR 569606A 题解

::: warning

WIP

:::

## 题面

<!-- @include: ../../source/ZR-569606A/problem.md -->

## 解题

关于子序列，这是一个 DP 题。

### 问题定义

大问题：前 $n$ 个中的最大方案数

小问题：前 $i$ 个中选 $j$ 个的最大方案数

### 状态定义

$f_{i, j} :=$ 前 $i$ 个中选择 $j$ 个的方案数

### 状态转移

对于第 $i$ 个数：

- 如果：$j \mid a_i$，那么 $f_{i, j} = f_{i-1, j} + f_{i-1, j-1}$
- 否则：$f_{i, j} = f_{i-1, j}$

### 答案

$$ f_{n, 1} + f_{n, 2} + \ldots + f_{n, n} $$

### 边界

$$ f_{i, 0} = f_{0, 0} = 1 $$
$$ f_{0, j} = 0 $$

::: details 这样就能写出来 O(n²)

@[code cpp](../../source/ZR-569606A/dp.cpp)

:::

这个方法的缺陷：

- 时间达到 $O(10^12)$，会 TLE
- 空间达到 $O(10^12)$，会 MLE，因此程序中 `N = 1e3 + 5`

观察状态转移方程，发现 $f_{i, j}$ 仅与 $f_{i-1, j}$ 和 $f_{i-1, j-1}$ 有关，所以可以滚动优化。

::: details 解决了 MLE

@[code cpp](../../source/ZR-569606A/dp-rolled.cpp)

:::

但 TLE 则么解决呢？

WIP
